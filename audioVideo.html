<!DOCTYPE html>
<html>
<!-- En-tête de la page -->
<head>
	<meta charset="utf-8" />
	<link rel="stylesheet" href="styleTest.css" />
	<title>Page test Audio Video</title>
</head>

<body>

<div style="text-align:center;">
  <video id="basic-stream" class="videostream" autoplay></video>
  <p><button id="play-button">Capture audio video</button> <button id="stop-button">Stop</button></p>
</div>


<script>

var video = document.querySelector('#basic-stream'); // variable de la balise
var buttonPlay = document.querySelector('#play-button'); // varible du bouton play
var buttonStop = document.querySelector('#stop-button'); // variable du bouton stop

// On crée l'objet en fonction navigateur
navigator.getUserMedia = ( navigator.getUserMedia ||
                       navigator.webkitGetUserMedia ||
                       navigator.mozGetUserMedia ||
                       navigator.msGetUserMedia);

// méthode au clic du bouton play
buttonPlay.addEventListener('click', function(e) {
  if (navigator.getUserMedia) { // si le navigateur implémente bien getUserMedia
    navigator.getUserMedia (
      // constraintes aux choix
      {
         video: true,
         audio: true
      },

      // fonction pour afficher la video en cas de successCallBack
      function(localMediaStream) {
         video.src = window.URL.createObjectURL(localMediaStream);
         // Do something with the video here, e.g. video.play()
      },

      // en cas de errorCallback
      function(err) {
         alert("The following error occured: " + err);
      }
    );
  } else {
   alert("getUserMedia not supported");
  }
}, false);

// méthode au clic du bouton stop
buttonStop.addEventListener('click', function(e) {
  video.pause();
  localMediaStream.stop();
}, false);

</script>

</body>
</html>